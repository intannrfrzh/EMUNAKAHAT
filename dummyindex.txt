<?php

// Include required files

require_once '../PUPP-main/Config/database.php';
require_once '../PUPP-main/app/Model/M5model.php';
require_once '../PUPP-main/app/Model/M3model.php';
require_once '../PUPP-main/app/Model/M1model.php';
require_once '../PUPP-main/app/Model/M2model.php';
require_once '../PUPP-main/app/Model/M4model.php';

require_once '../PUPP-main/app/Controller/M5controller/userController.php';
require_once '../PUPP-main/app/Controller/M5controller/staffController.php';

require_once '../PUPP-main/app/Controller/M1controller/userProfileController.php';
require_once '../PUPP-main/app/Controller/M1controller/staffProfileController.php';

require_once '../PUPP-main/app/Controller/M2controller/staffCourseController.php';
require_once '../PUPP-main/app/Controller/M2controller/staffRequestController.php';
require_once '../PUPP-main/app/Controller/M2controller/userCourseController.php';                                                   
require_once '../PUPP-main/app/Controller/M2controller/userRequestController.php';

require_once '../PUPP-main/app/Controller/M3controller/staffMarRegController.php';
require_once '../PUPP-main/app/Controller/M3controller/userMarRegController.php';

require_once '../PUPP-main/app/Controller/M4controller/staffControl.php';
require_once '../PUPP-main/app/Controller/M4controller/userControl.php';

// Define routes
$routes = [
    // Root URL route
    '/PUPP-main' => 'UserProfileController@index',
    
    // Module 5 routes
    'user/module5' => 'UserController@module5Action',
    'staff/module5' => 'StaffController@module5Action',

    // Module 1 routes
    'user/profile' => 'UserProfileController@index',
    'staff/profile' => 'StaffProfileController@index',

    // Module 2 routes
    'staff/course' => 'StaffCourseController@index',
    'staff/request' => 'StaffRequestController@index',
    'user/course' => 'UserCourseController@index',
    'user/request' => 'UserRequestController@index',

    // Module 3 routes
    'staff/marriage-registration' => 'StaffMarRegController@index',
    'user/marriage-registration' => 'UserMarRegController@index',

    // Module 4 routes
    'staff/control' => 'StaffControl@index',
    'user/control' => 'UserControl@index',

];

// Get requested URI
$requestUri = $_SERVER['REQUEST_URI'];
$requestUri = trim($requestUri, '/');

// Check if the requested URI matches any defined route
if (array_key_exists($requestUri, $routes)) {
    // Extract controller and action from the route
    list($controllerName, $action) = explode('@', $routes[$requestUri]);

    // Include the controller file
    require_once "../PUPP-main/app/Controller/{$controllerName}.php";

    // Create controller object and call the action method
    $controller = new $controllerName();
    $controller->$action();
} else {
    // If no matching route is found, return a 404 response
    http_response_code(404);
    echo '404 Not Found';
}
?>
